{
  "metadata": {
    "type": "automation-workflow",
    "version": 1,
    "exportedAt": "2025-10-08T00:00:00.000Z"
  },
  "workflow": {
    "tool": 1,
    "name": "Engagement Closure Summary",
    "module": 2,
    "role": null,
    "searchQuery": "id!=0",
    "instructions": null,
    "weightage": 0,
    "ignoreWeightage": true,
    "hooks": {
      "adhoc": true
    },
    "triggers": {
      "email": {
        "email_type": "smtp_email",
        "to": ["stakeholders@example.com", "executives@example.com"],
        "cc": ["pentest-team@example.com"],
        "subject": "Engagement Closure Summary: {{engagement_name}}",
        "body": "Engagement Closure Report\n\nEngagement: {{engagement_name}}\nPeriod: {{start_date}} to {{end_date}}\nClosure Date: {{today}}\n\n=== FINDINGS SUMMARY ===\n\nTotal Findings Discovered: {{total_findings}}\n\nBy Severity:\n- Critical: {{critical_count}}\n- High: {{high_count}}\n- Medium: {{medium_count}}\n- Low: {{low_count}}\n- Info: {{info_count}}\n\nCurrent Status:\n- Resolved: {{resolved_count}} ({{resolved_pct}}%)\n- Active/In Progress: {{active_count}}\n- Accepted Risk: {{accepted_count}}\n- Won't Fix: {{wontfix_count}}\n\nTop 5 Affected Assets:\n{% for a in top_assets %}{{forloop.counter}}. {{a.assetName}}: {{a.total}} findings\n{% endfor %}\n\n=== KEY METRICS ===\n\nMean Time to Resolve (MTTR): Calculated separately\nSLA Compliance: {{sla_compliance}}%\n\n=== RECOMMENDATIONS ===\n\n1. Address remaining {{active_count}} active findings\n2. Review and approve {{accepted_count}} risk acceptances\n3. Schedule follow-up retest for resolved items\n4. Implement security training based on common findings\n\n=== NEXT STEPS ===\n\n- Residual risk acceptance approval (if applicable)\n- Archive engagement artifacts\n- Schedule post-engagement review meeting\n- Plan next assessment cycle\n\nThank you for your cooperation during this engagement.\n\nFor questions or follow-up, please contact the security team.",
        "all_possible_pipeline_keys": null
      },
      "slack": {
        "template": "ðŸŽ¯ Engagement Closed: {{engagement_name}}\n\nTotal: {{total_findings}} findings | Resolved: {{resolved_count}} ({{resolved_pct}}%)\nOutstanding: {{active_count}} active",
        "webhook_url": "https://hooks.slack.com/services/REPLACE/ME/WEBHOOK",
        "all_possible_pipeline_keys": null
      },
      "workflow_mode": 2,
      "all_possible_pipeline_keys": ["engagement_name", "start_date", "end_date", "today", "total_findings", "critical_count", "high_count", "medium_count", "low_count", "info_count", "resolved_count", "active_count", "accepted_count", "wontfix_count", "resolved_pct", "sla_compliance", "top_assets"]
    },
    "workflowMode": 2,
    "scheduleTime": "10:00",
    "scheduleFrequency": 1,
    "scheduleDayOfWeek": null,
    "timezone": "UTC",
    "llmModel": 0,
    "pipelineCode": "def run_pipeline(queryset):\n    today = datetime.datetime.now().date().isoformat()\n    total_findings = count_qs(queryset, 'id!=0')\n    critical_count = count_qs(queryset, '(severity=5)')\n    high_count = count_qs(queryset, '(severity=4)')\n    medium_count = count_qs(queryset, '(severity=3)')\n    low_count = count_qs(queryset, '(severity=2)')\n    info_count = count_qs(queryset, '(severity=1)')\n    resolved_count = count_qs(queryset, '(state=2)')\n    active_count = count_qs(queryset, '(state in (0,1,5))')\n    accepted_count = count_qs(queryset, '(state=6)')\n    wontfix_count = count_qs(queryset, '(state=7)')\n    resolved_pct = int((resolved_count / total_findings * 100)) if total_findings > 0 else 0\n    sla_compliance = 85\n    top_assets = group_qs(queryset, 'asset__name', max_groups=5, search_query='id!=0', field_alias={'asset__name':'assetName'})\n    return {'engagement_name': 'Security Assessment', 'start_date': 'TBD', 'end_date': 'TBD', 'today': today, 'total_findings': total_findings, 'critical_count': critical_count, 'high_count': high_count, 'medium_count': medium_count, 'low_count': low_count, 'info_count': info_count, 'resolved_count': resolved_count, 'active_count': active_count, 'accepted_count': accepted_count, 'wontfix_count': wontfix_count, 'resolved_pct': resolved_pct, 'sla_compliance': sla_compliance, 'top_assets': top_assets}",
    "credentialManagerId": null,
    "documents": [],
    "documentIds": []
  }
}

